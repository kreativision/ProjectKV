{% extends 'admin.layout.html' %}
{% set active='settings' %}

{% block admin_content %}
<div class="container-fluid px-1 mt-3">
  <div class="container">
    <div class="row acc-info">
      <!-- Info Section: always visible -->
      <div class="col-md-6 d-flex flex-column align-items-center">
        <div class="img-container position-relative">
          <img src="{{url_for('static', filename='images/project-images/random-1.jpg')}}" alt=""
            class="acc-img mt-3 shadow">
          <button class="btn btn-sm btn-warning edit-img-btn shadow" data-toggle="tooltip" data-placement="bottom" title="Change Profile Picture" >
            <i class="fas fa-pencil-alt"></i>
          </button>
        </div>
        <p class="h2 text-dark mt-4">{{current_user.username}}</p>
        <p class="h6 text-dark font-italic" id="adminEmail">{{current_user.email}}</p>
        <p class="h6 text-dark">+91 {{current_user.contact}}</p>
        <!-- Action Button group -->
        <div class="row mt-5 justify-content-center w-100">
          <div class="col-sm-12 col-md-6 d-flex px-0 justify-content-center">
            <button class="btn d-flex mt-2 align-items-center btn-light font-weight-bold shadow"
              data-target="#detailsCollapse" onclick="triggerForm('#detailsCollapse','#passwordCollapse')">
              <i class="fas fa-pencil-alt mr-2"></i>EDIT DETAILS
            </button>
          </div>
          <div class="col-sm-12 col-md-6 d-flex px-0 justify-content-center">
            <button class="btn d-flex mt-2 align-items-center btn-light font-weight-bold shadow" data-target="#passwordCollapse"
              onclick="triggerForm('#passwordCollapse','#detailsCollapse')">
              <i class="fas fa-pencil-alt mr-2"></i>CHANGE PASSWORD
            </button>
          </div>
        </div>
      </div>


      <!-- Collapse sections: Click to show -->
      <div class="col-md-6 d-flex flex-column align-items-center px-1">

        <!-- Edit details -->
        <div class="collapse w-100 mt-2 {{'show' if detailsForm.errors}}" id="detailsCollapse">
          <div class="card bg-dark border-0">
            <div class="card-header border-0 bg-dark text-center">
              <p class="h4 text-light">Edit Account Details</p>
              <small class="text-light font-italic" id="guide">Change one or more fields you wish to change.</small>
            </div>
            <form action="" method="POST">
              {{detailsForm.hidden_tag()}}
              <fieldset>
                <div class="card-body py-0">
                  <div class="container bg-light f-field">
                    <div class="form-group">
                      {{detailsForm.username(class="form-control")}}
                      {{detailsForm.username.label(class="form-control-label")}}
                      <div class="invalid-feedback">
                        <span><i class="fas fa-times-circle mr-2"></i></span><span id="name_error"></span>
                      </div>
                    </div>
                  </div>
                  <div class="container bg-light f-field">
                    <div class="form-group">
                      {{detailsForm.email(class="form-control")}}
                      {{detailsForm.email.label(class="form-control-label")}}
                      <div class="invalid-feedback">
                        <span><i class="fas fa-times-circle mr-2"></i></span><span id="email_error"></span>
                      </div>
                    </div>
                  </div>
                  <div class="container bg-light f-field">
                    <div class="form-group">
                      {{detailsForm.contact(class="form-control")}}
                      {{detailsForm.contact.label(class="form-control-label")}}
                      <div class="invalid-feedback">
                        <span><i class="fas fa-times-circle mr-2"></i></span><span id="contact_error"></span>
                      </div>
                    </div>
                  </div>
                  <div class="container bg-light f-field">
                    <div class="form-group">
                      {% if detailsForm.password.errors %}
                      {{detailsForm.password(class="form-control is-invalid")}}
                      <div class="invalid-feedback">
                        {% for error in detailsForm.password.errors %}
                        <span><i class="fas fa-times-circle mr-2"></i></span><span id="password_error">{{error}}</span>                        
                        {% endfor %}
                      </div>
                      {% else %}
                      {{detailsForm.password(class="form-control")}}
                      {% endif %}
                      {% if not detailsForm.password.errors %}
                      <div class="invalid-feedback">
                        <span><i class="fas fa-times-circle mr-2"></i></span><span id="password_error"></span>
                      </div>
                      {% endif %}
                      <small class="helper-text font-italic text-muted">Password needed to make changes.</small>
                      {{detailsForm.password.label(class="form-control-label")}}
                    </div>
                  </div>
                </div>
                <div class="card-footer border-0 d-flex justify-content-end pt-3">
                  <input type="hidden" name="form" value="info">
                  <button type="button" class="btn btn-secondary mr-2 shadow"
                    onclick="closeCollapse('#detailsCollapse')">Cancel</button>
                  {{detailsForm.submit(class="btn btn-warning shadow")}}
                </div>
              </fieldset>
            </form>
          </div>
        </div>

        <!-- <div class="collapse w-100 mt-2" id="passwordCollapse">
          <div class="card bg-dark border-0">
            <div class="card-header border-0 bg-dark">
              <p class="h4 text-center text-light">Edit Account Details</p>
            </div>
            <form action="" method="POST">
              {{passwordForm.hidden_tag()}}
              <fieldset>
                <div class="card-body">
                  <div class="container bg-light f-field">
                    <div class="form-group">
                      {% if passwordForm.current_password.errors %}
                      {{passwordForm.current_password(class="form-control is-invalid")}}
                      <div class="invalid-feedback">
                        {% for error in passwordForm.current_password.errors%}
                        <span><i class="fas fa-times-circle mr-2"></i>{{error}}</span>
                        {% endfor %}
                      </div>
                      {% else %}
                      {{passwordForm.current_password(class="form-control")}}
                      {% endif %}
                      {{passwordForm.current_password.label(class="form-control-label")}}
                    </div>
                  </div>
                  <div class="container bg-light f-field">
                    <div class="form-group">
                      {% if passwordForm.new_password.errors %}
                      {{passwordForm.new_password(class="form-control is-invalid")}}
                      <div class="invalid-feedback">
                        {% for error in passwordForm.new_password.errors %}
                        <span class="text-info">
                          <i class="fas fa-exclamation-circle mr-2"></i>
                          {{error}}
                        </span>
                        {% endfor %}
                      </div>
                      {% else %}
                      {{passwordForm.new_password(class="form-control")}}
                      {% endif %}

                      {#{% if not passwordForm.new_password.errors %}
                      <div class="invalid-feedback">
                        <span><i class="fas fa-times-circle mr-2"></i></span><span id="new_password_error"></span>
                      </div>
                      {% endif %}#}

                      {{passwordForm.new_password.label(class="form-control-label")}}
                    </div>
                  </div>
                  <div class="container bg-light f-field">
                    <div class="form-group">
                      {% if passwordForm.confirm_new_password.errors %}
                      {{passwordForm.confirm_new_password(class="form-control is-invalid")}}
                      <div class="invalid-feedback">
                        {% for error in passwordForm.confirm_new_password.errors %}
                        <span class="text-info">
                          <i class="fas fa-exclamation-circle mr-2"></i>
                          {{error}}
                        </span>
                        {% endfor %}
                      </div>
                      {% else %}
                      {{passwordForm.confirm_new_password(class="form-control")}}
                      {% endif %}
                      {{passwordForm.confirm_new_password.label(class="form-control-label")}}
                    </div>
                  </div>
                </div>
                <div class="card-footer border-0 d-flex justify-content-end">
                  <input type="hidden" name="form" value="password">
                  <button type="button" class="btn btn-secondary mr-2 shadow"
                    onclick="closeCollapse('#passwordCollapse')">Cancel</button>
                  {{passwordForm.submit(class="btn btn-warning shadow")}}
                </div>
              </fieldset>
            </form>
          </div>
        </div> -->
      </div>
    </div>
  </div>
</div>
{% endblock admin_content %}


{% block page_script %}
<script src="{{url_for('BP_admin.static', filename='js/settings.js')}}"></script>
{% endblock page_script %}